# S3 Service Documentation

The S3 service provides functionality for uploading PDFs to AWS S3 and generating pre-signed URLs for secure access to these files.

## Key Features

- **PDF Upload**: Uploads PDF buffers to S3 with appropriate content types and dispositions
- **Pre-signed URLs**: Generates temporary secure URLs that expire after a configurable time
- **View URLs**: Creates URLs specifically for viewing PDFs in the browser (inline content disposition)
- **Download URLs**: Creates URLs specifically for downloading PDFs (attachment content disposition)

## API Reference

### uploadPDF(options)

Uploads a PDF to S3 and returns both the S3 key and a pre-signed URL for viewing.

**Parameters:**
- `options` (Object): An object containing:
  - `pdfBuffer` (Buffer): The PDF file as a buffer
  - `userId` (String): The ID of the user who owns the PDF
  - `reportName` (String): The name of the report
  - `repository` (String): The repository name the report is for

**Returns:**
- `Promise<Object>`: An object containing:
  - `key` (String): The S3 key where the PDF is stored
  - `signedUrl` (String): A pre-signed URL for viewing the PDF

### getSignedUrl(key, expiresIn)

Generates a pre-signed URL for viewing a PDF in the browser.

**Parameters:**
- `key` (String): The S3 key of the PDF
- `expiresIn` (Number, optional): The expiration time in seconds (default: 86400 - 24 hours)

**Returns:**
- `Promise<String>`: A pre-signed URL with inline content disposition

### getDownloadUrl(key, filename, expiresIn)

Generates a pre-signed URL for downloading a PDF.

**Parameters:**
- `key` (String): The S3 key of the PDF
- `filename` (String, optional): The filename for the downloaded file (default: 'report.pdf')
- `expiresIn` (Number, optional): The expiration time in seconds (default: 86400 - 24 hours)

**Returns:**
- `Promise<String>`: A pre-signed URL with attachment content disposition

## Security Considerations

- All URLs generated by this service are temporary and will expire after the specified time
- The pre-signed URLs contain authentication information in the URL parameters
- No public access to the S3 bucket is required, as authentication is handled via the pre-signed URLs
- Use HTTPS for production environments to ensure URL parameters remain encrypted

## Usage Example

```javascript
// Upload a PDF and get signed URL
const { key, signedUrl } = await s3Service.uploadPDF({
  pdfBuffer,
  userId: user.id,
  reportName: 'Q1 Report',
  repository: 'acme/project'
});

// Get a URL for viewing a PDF
const viewUrl = await s3Service.getSignedUrl(key);

// Get a URL for downloading a PDF
const downloadUrl = await s3Service.getDownloadUrl(key, 'quarterly-report.pdf');
```
